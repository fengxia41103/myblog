@startuml

autonumber "<font color=red><b>Message 00:"

actor "Workload User" as User
actor "Hardware Owner" as Owner
actor Launchpad
participant "Automation Service" as Tower
participant "Runtime Service" as RHHI
participant "Discovery Service" as Discovery
participant "Server Management Service" as LXCA
participant "OS Deployment Service" as Provisioning
participant "Inventory Service" as Netbox
participant "Service registry" as Registry
collections Servers #ff6a00
participant Workload #8bc34a

== PHASE 0: PLAN & HOOKUP SERVER  ==

Owner -> Servers: collect & build hardware inventory
Owner -> Netbox: plan/design for its use, and assign configs
Owner -> Servers: cabling based on a design
Owner -> Launchpad: trigger to kickoff

== PHASE 1: DISCOVER SERVER ==

Launchpad -> Discovery: scan for new hardware
Discovery -> Servers: discovery servers on network x.x.x.x
Discovery -> Tower: discovered list[server(ip, uuid)]
Tower -> Netbox: server_id = identify_this_server(server_ip, server_uuid)
Tower -> Netbox: get_server_role(server_id)
Tower -> Netbox: get_server_configs(server_id). This includes config pattern, OS to use, and such.

== PHASE 2: PREPARE SERVER ==
Tower -> LXCA: manage(server_id)
LXCA -> Servers: bring server under management
Tower -> LXCA: config_server(server_id). This includes firmware, bios,etc..
LXCA -> Servers: apply config patterns
LXCA -> Tower: ready for provisioning

== PHASE 3: PROVISION SERVER ==
Tower -> Provisioning: provision_os(server_id)
Provisioning -> Servers: install OS
Provisioning -> Tower: ready for workload

== PHASE 4: DEPLOY RHHI ==

Tower -> Servers: deploy RHHI
Tower -> RHHI: config RHHI
Tower -> RHHI: validate RHHI

== PHASE 5: DEPLOY BRAIN WORKLOAD ==

Tower -> RHHI: deploy workload
Tower -> Workload: config workload
Tower -> Workload: validate workload
Workload -> Registry: workload is ready

== PHASE 6: USE BRAIN WORKLOAD ==

User -> Workload: use workload and be happy

@enduml
