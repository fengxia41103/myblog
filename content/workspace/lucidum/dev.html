<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>dev.html</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>

</head>

<body>

<p>Title: New Dev Date: 2022-03-29 14:50 Tags: dev Slug: lucidum new dev Author: Feng Xia</p>
<h1 id="online-tool-accounts">Online tool accounts</h1>
<p>Make sure the get the <code>email</code> first because all followings would either send an confirmation email to you, or can use the Offcie365 oauth.</p>
<ol type="1">
<li>email &amp; calendar: office365</li>
<li>github to code repo (can your existing username, must set up 2-factor authentication)</li>
<li>VPN</li>
<li>zoom</li>
<li>slack</li>
<li>AWS access ID &amp; key, AWS CLI, then <code>aws configure</code></li>
<li>Atlassian Confluence</li>
<li>Atlassian Jira</li>
</ol>
<h1 id="configure-aws-cli">Configure AWS CLI</h1>
<p>All build resources and test VMs are on AWS. Once you have the AWS access ID &amp; key, follow <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html#cli-configure-quickstart-config">AWS official doc</a> to setup the AWS cli:</p>
<pre class="shell"><code>$ aws configure
AWS Access Key ID [None]: &lt;your ID&gt;
AWS Secret Access Key [None]: &lt;your key&gt;
Default region name [None]: us-west-1 &lt;-- use this!
Default output format [None]: json</code></pre>
<p>On Linux, the values are saved in <code>.aws/config</code> and <code>./aws/recentials</code>.</p>
<h1 id="ssh-to-aws">SSH to AWS</h1>
<ol type="1">
<li>Login VPN</li>
<li>Check AWS parameter store for the private key <code>*.pem</code>.</li>
<li>Save local to a file.</li>
<li><strong>MUST</strong>: <code>chmod 600 &lt;your key&gt;.pem</code></li>
<li><code>ssh -i &lt;path to pem&gt; ubuntu@&lt;remote host IP&gt;</code></li>
</ol>
<h1 id="use-an-virtual-appliance-locally-as-kvm">Use an virtual appliance locally as kvm</h1>
<ol type="1">
<li>Download an <code>.ova</code> image from our S3.</li>
<li>Find the matching SSH and admin pwd.</li>
<li>Extract disk image file (<code>.vmdk</code>): <code>tar xvf &lt;your image&gt;.ova</code></li>
<li>Convert <code>.vmdk</code> to <code>.qcow2</code>: <code>qemu-img convert -O qcow2 &lt;the disk image from OVA&gt;.vmdk &lt;your&gt;.qcow2</code></li>
<li>Launch <code>&lt;your&gt;.qcow2</code>.</li>
<li>Browse to <code>https://&lt;kvm's ip&gt;</code>.</li>
</ol>
<p>If you launch &gt; 1 instances, the <code>netplan</code> config in the image will result in instances acquiring the same IP! To change that:</p>
<ol type="1">
<li>SSH to your instance.</li>
<li><p>Replace <code>/etc/netplan/50-cloud-init.yaml</code> with contents:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb2-1" title="1"><span class="fu">network:</span></a>
<a class="sourceLine" id="cb2-2" title="2">    <span class="fu">ethernets:</span></a>
<a class="sourceLine" id="cb2-3" title="3">        <span class="fu">ens3:</span></a>
<a class="sourceLine" id="cb2-4" title="4">            <span class="fu">dhcp4:</span><span class="at"> </span><span class="ch">true</span></a>
<a class="sourceLine" id="cb2-5" title="5">            <span class="fu">dhcp-identifier:</span><span class="at"> mac &lt;--- ADD THIS LINE!</span></a>
<a class="sourceLine" id="cb2-6" title="6">            <span class="fu">match:</span></a>
<a class="sourceLine" id="cb2-7" title="7">                <span class="fu">macaddress:</span><span class="at"> 02:00:00:f8:b2:a5</span></a>
<a class="sourceLine" id="cb2-8" title="8">            <span class="fu">set-name:</span><span class="at"> ens3</span></a>
<a class="sourceLine" id="cb2-9" title="9">    <span class="fu">version:</span><span class="at"> </span><span class="dv">2</span></a></code></pre></div></li>
<li><p>Restart net: <code>sudo netplan apply</code>.</p></li>
</ol>
<h1 id="online-resources">Online resources</h1>
<p>Most of these resources can be accessed using your Office365 oauth which you would have received on your first day. The ones needs separate account will be indicated below.</p>
<p>Resource are organized by its origin, eg. Jira &amp; Confluence are all by Lucidum’s <code>atlassian</code> access.</p>
<h2 id="atlassian-jira-confluence">Atlassian: Jira &amp; Confluence</h2>
<p>Jira requires admin granting access separately even w/ 365.</p>
<ol type="1">
<li><a href="https://luciduminc.atlassian.net/jira/software/projects/CON/boards/16">connector</a></li>
<li><a href="https://luciduminc.atlassian.net/jira/software/projects/DEVOPS/boards/13">devops</a></li>
<li><a href="https://luciduminc.atlassian.net/jira/plans/2/scenarios/2?vid=5#plan/backlog">quarter release planning</a></li>
</ol>
<p>Confluence/docs:</p>
<ol type="1">
<li><a href="https://luciduminc.atlassian.net/wiki/spaces/DEVOPS">confluence</a>, uses Office365 oauth.</li>
</ol>
<h2 id="githubcode">Github/code</h2>
<ol type="1">
<li><a href="https://github.com/LucidumInc">github repos</a>, need github admin to grant access.</li>
</ol>
<h2 id="aws">AWS</h2>
<ol type="1">
<li><a href="https://us-west-1.console.aws.amazon.com/ec2/v2/home?region=us-west-1#Instances:v=3">EC2 instances</a></li>
<li><a href="https://s3.console.aws.amazon.com/s3/buckets?region=us-west-1">S3 built images</a></li>
<li><a href="https://us-east-1.console.aws.amazon.com/systems-manager/parameters/?region=us-east-1&amp;tab=Table">OVA ssh pwd &amp; admin pwd</a></li>
</ol>
<h2 id="lucidum-special">Lucidum SPECIAL</h2>
<ol type="1">
<li><a href="https://172.16.200.160:5500/customers">customer list &amp; ECR token</a></li>
<li><a href="http://172.16.200.173:8080/">Jenkins</a>, needs separate (username, pwd).</li>
</ol>
<h1 id="docker-images">Docker images</h1>
<p>There are three types of images used in our application:</p>
<ol type="1">
<li>AMI image: no modification, Ubuntu 18.04.</li>
<li>Lucidum base images: there are multiple, each w/ a <code>Dockerfile</code>.</li>
<li>Lucidum component images: = Lucidum base + component code</li>
</ol>
<h2 id="base-images">Base images</h2>
<p><code>image-builder-base</code> is the repo responsible to build these base images:</p>
<pre class="shell"><code>  drwxrwxr-x  2 fengxia fengxia 4096 Mar 31 12:55 connector-base
  drwxrwxr-x  2 fengxia fengxia 4096 Mar 31 12:55 image-builder-base
  drwxrwxr-x  2 fengxia fengxia 4096 Mar 31 12:55 merger-base
  drwxrwxr-x  2 fengxia fengxia 4096 Mar 31 12:55 mvp1-backend-base
  drwxrwxr-x  2 fengxia fengxia 4096 Mar 31 12:55 packer-ansible-base</code></pre>
<p>The <code>Jenkinsfile</code> in this repo is essentially enumerating each folder listed above, if it finds a <code>Dockerfile</code>, runs docker build and push to Azure’s docker registry (aka. ACR). Tag is read from a <code>.json</code> in the same folder w/ <code>Dockerfile</code>.</p>
<h2 id="application-componentservice-images">Application component/service images</h2>
<p>Use one of the Lucidum base images as starting point, components are further built into its own docker images.</p>
<p>Jenkinsfile are defined in three possible places:</p>
<ol start="0" type="1">
<li>In component’s repo</li>
<li><code>lucidum-deploy</code> repo</li>
<li>as <em>managed config files</em> inside Jenkins itself</li>
</ol>
<table>
<thead>
<tr class="header">
<th>Component</th>
<th>Base Image</th>
<th>Jenkinsfile</th>
<th>Jenkins Pipelines</th>
<th>Push To</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>connector-x</code></td>
<td><code>connector-base</code></td>
<td>managed config file</td>
<td>connector-xxx</td>
<td>ECR</td>
</tr>
<tr class="even">
<td>backend &amp; frontend</td>
<td><code>image-builder-base</code></td>
<td><code>mvp1_backend</code></td>
<td>mvp1_backend</td>
<td>S3</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="virtual-appliance">Virtual Appliance</h1>
<p>Virtual appliance is a VM image with everything installed and ready-for-use. This is the host environment for all Lucidum components.</p>
<ol type="1">
<li>Use the <code>image-builder-base</code> docker as Jenkins’ agent.</li>
<li>Create an AMI image from this env (now we are inside <code>image-builder-base</code> docker!)</li>
<li>Export the AMI to a <code>.ova</code> w/ disk format <code>.vmdk</code>.</li>
<li>Push to <code>s3/packer-ami-pipelines-ubuntu18-vmdk</code> bucket.</li>
</ol>
<h1 id="notes-todo">Notes TODO</h1>
<ol type="1">
<li>UI has version/commit info: needs before release, for debugging</li>
<li>Categorize bugs per components or even UI menu: all bugs will appear to be UI</li>
<li><p>Definition of release thresholds. Missing PM? but we have UAT.</p>
<ol type="1">
<li>There are two type of UAT: branch new end-2-end, and incremental on existing customer’s version.</li>
<li>regression: end-2-end w/ all test cases available</li>
<li>UAT: happy path all test cases + H bug test cases</li>
</ol></li>
</ol>
<h2 id="ui-observation">UI observation</h2>
<p>To follow up the discussion (and I’m gonna skip the screenshots then) and ignore if it doesn’t make sense. There could be a lot of rookie’s mistakes here.</p>
<p>Menu/navigation:</p>
<ol type="1">
<li><code>Settings</code>: <code>Query Management</code> get its own 1-level nagivatioin.</li>
<li>Three <code>Field Management</code> as submenu items of <code>Query Management</code> main.</li>
<li>Unify word in this menu, <code>Manage license</code> instead of <code>License</code>, for example.</li>
<li>If <code>integration</code> is for <code>Action Center</code>, then its a submenu under <code>Action...</code> main.</li>
</ol>
<p>Connector:</p>
<ol type="1">
<li>Connector <code>Edit</code> should be visible w/o hover.</li>
<li>Connector error should yield a general error msg at the bottom of its card so to bring attention to admin. 1. Change the “!” icon to a clickable component, eg. link button/text, says “details”.</li>
</ol>
<p>Mega guery drawer:</p>
<ol type="1">
<li>Two <code>Add Condition</code> are adding two different logic, <code>OR</code> vs. <code>AND</code>, thus should worded differently.</li>
</ol>
<p>Mega query dropdown menu when selecting a field:</p>
<ol type="1">
<li>Not obvious the left column is <strong>grouping</strong>, and right column is details inside selected group. Give the group column a header, eg. “Asset Group”, and field column eg. “Query Field”. If given header, remove <code>bold</code> style from group values.</li>
<li>Subgrouping of <em>details</em> in a group, eg. A-Z, needs navigation. Because the submenu has limited space, layout these will be challenging.</li>
<li>Details’ subgrouping header needs stand out, eg. color.</li>
<li>Needs padding top, left, and bottom, eg. <code>2em</code>.</li>
</ol>
<p>Overall, I feel this dropdown menu is trying to achieve too much, but no thought yet.</p>
<p>Overview:</p>
<ol type="1">
<li>The pane on the right, each section needs separation, eg. line.</li>
<li>Would recommend group <code>User</code> pie w/ <code>New User Found</code> in one card, and so for <code>Asset</code> and <code>Data</code>.</li>
<li>Recommend to put <code>ingestion flow</code> in a card also.</li>
</ol>
<p>Report center charts:</p>
<ol type="1">
<li>Subtitle <code>Bar Chart</code> doesn’t add additional info to user because the chart is a bar chart. If using it to differentiate two charts from the same data resource, create a meaningful data attribute representing this in the system first. Recommend to replace eventually.</li>
</ol>
<p>Useful links:</p>
<ol type="1">
<li><a href="https://material.io/components">material io components</a>, try to use these lingos more &amp; more in daily discussions, especially w/ UI developers.</li>
<li><a href="https://v4.mui.com/">reactJS material UI</a>, if we are using REACT for frontend, then this is a lib to achieve material in previous bullet. Take a look of its components and capabilities, that will give designer an idea what can be done by coder, easy or hard.</li>
</ol>

</body>
</html>
